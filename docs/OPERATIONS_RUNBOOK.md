# Runbook

## Типовые инциденты и действия

### ASR не отвечает
- Проверьте `RIVA_HOST` и сетевое соединение.
- Включите заглушку: удалите `RIVA_HOST` и перезапустите сервис.

### LLM тормозит или недоступен
- Убедитесь, что vLLM запущен и доступен по `VLLM_BASE_URL`.
- Переключите модель на меньшую (`VLLM_MODEL`).
- При недоступности используйте заранее сгенерированные ответы (**TODO**).

### TTS не генерирует звук
- Проверьте наличие весов XTTS‑v2.
- Посмотрите логи: `XTTS not available` ⇒ используется Silero или синусоида.

### ATS недоступен
- `/ats/sync` возвращает `502`. Запросы автоматически ретраятся с экспоненциальной
  задержкой. Проверьте `MOCK_ATS_URL`.

### FAISS индекс повреждён
- Пересоздайте индекс: удалите том `faiss-index` и перезапустите.

## Чек‑лист релиза

- Обновить веса моделей и индексы.
- Прогнать `pytest` и `scripts/smoke_e2e.py`.
- Обновить документацию при изменении схем/эндпоинтов.

## Откат

- Храните предыдущий образ Docker.
- При проблемах выполните `docker compose down` и запустите стабильную версию.

